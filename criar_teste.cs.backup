using System;
using OfficeOpenXml;
using System.IO;

try {
    ExcelPackage.LicenseContext = LicenseContext.NonCommercial;
    
    using (var package = new ExcelPackage()) {
        var worksheet = package.Workbook.Worksheets.Add("Teste");
        
        worksheet.Cells[1, 1].Value = "Fornecedor";
        worksheet.Cells[1, 2].Value = "Descrição";
        worksheet.Cells[1, 3].Value = "Valor";
        worksheet.Cells[1, 4].Value = "Vencimento";
        worksheet.Cells[1, 5].Value = "Status";
        
        worksheet.Cells[2, 1].Value = "Teste Fornecedor";
        worksheet.Cells[2, 2].Value = "Teste descrição";
        worksheet.Cells[2, 3].Value = 1000.50;
        worksheet.Cells[2, 4].Value = "15/10/2025";
        worksheet.Cells[2, 5].Value = "Pendente";
        
        File.WriteAllBytes("teste_upload.xlsx", package.GetAsByteArray());
        Console.WriteLine("Arquivo teste criado: teste_upload.xlsx");
    }
} catch (Exception ex) {
    Console.WriteLine($"Erro: {ex.Message}");
}
